# üçéü•ùüçä –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Ñ—Ä—É–∫—Ç–æ–≤ —Å Transfer Learning

–ü—Ä–æ–µ–∫—Ç –ø–æ fine-tuning –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ `timm` –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Ñ—Ä—É–∫—Ç–æ–≤ (—è–±–ª–æ–∫–æ, –∫–∏–≤–∏, –º–∞–Ω–¥–∞—Ä–∏–Ω) —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –æ—Å–æ–∑–Ω–∞–Ω–Ω–æ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –∑–∞–º–æ—Ä–∞–∂–∏–≤–∞–Ω–∏—è/—Ä–∞–∑–º–æ—Ä–∞–∂–∏–≤–∞–Ω–∏—è –≤–µ—Å–æ–≤.

## üéØ –¶–µ–ª–∏ –ø—Ä–æ–µ–∫—Ç–∞

- –°–æ–∑–¥–∞—Ç—å –∏ –¥–æ–æ–±—É—á–∏—Ç—å –¥–≤–µ –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏ –∏–∑ —Ä–∞–∑–Ω—ã—Ö —Å–µ–º–µ–π—Å—Ç–≤ (`timm`): **ResNet18** –∏ **EfficientNet-B0**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å transfer learning —Å –æ—Å–æ–∑–Ω–∞–Ω–Ω–æ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–µ–π freeze/unfreeze
- –ü—Ä–∏–º–µ–Ω–∏—Ç—å –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –æ–±–æ–±—â–µ–Ω–∏—è
- –°—Ä–∞–≤–Ω–∏—Ç—å –º–æ–¥–µ–ª–∏ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–±—Ä–∞—Ç—å –ª—É—á—à—É—é
- –°–æ–∑–¥–∞—Ç—å –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏
- –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ª—É—á—à—É—é –º–æ–¥–µ–ª—å –≤ ONNX –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞

## üèóÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
fine-tuning/
‚îú‚îÄ‚îÄ üìÅ data/                          # –î–∞–Ω–Ω—ã–µ
‚îÇ   ‚îú‚îÄ‚îÄ raw/                          # –ò—Å—Ö–æ–¥–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (210 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ apple/                    # 70 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —è–±–ª–æ–∫
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ kiwi/                     # 70 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –∫–∏–≤–∏
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ mandarin/                 # 70 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –º–∞–Ω–¥–∞—Ä–∏–Ω–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ processed/                    # –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
‚îÇ       ‚îú‚îÄ‚îÄ train/                    # –û–±—É—á–∞—é—â–∞—è –≤—ã–±–æ—Ä–∫–∞ (70%)
‚îÇ       ‚îú‚îÄ‚îÄ val/                      # –í–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–∞—è –≤—ã–±–æ—Ä–∫–∞ (15%)
‚îÇ       ‚îú‚îÄ‚îÄ test/                     # –¢–µ—Å—Ç–æ–≤–∞—è –≤—ã–±–æ—Ä–∫–∞ (15%)
‚îÇ       ‚îî‚îÄ‚îÄ dataset_info.csv          # –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –æ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–∏
‚îú‚îÄ‚îÄ üìÅ training/                      # –£—Ç–∏–ª–∏—Ç—ã –æ–±—É—á–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ config.py                     # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –¥–∞—Ç–∞-–∫–ª–∞—Å—Å—ã
‚îÇ   ‚îî‚îÄ‚îÄ utils.py                        # –£—Ç–∏–ª–∏—Ç—ã (seeds, device)
‚îú‚îÄ‚îÄ üìÅ experiments/                   # –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ [model]_experiment_[timestamp]/  # –ü–∞–ø–∫–∏ —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –∫–∞–∂–¥–æ–≥–æ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞
‚îÇ       ‚îú‚îÄ‚îÄ best_model.pth           # –õ—É—á—à–∞—è –º–æ–¥–µ–ª—å (–ø–æ val_accuracy)
‚îÇ       ‚îú‚îÄ‚îÄ results.json              # –ú–µ—Ç—Ä–∏–∫–∏ –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ       ‚îú‚îÄ‚îÄ confusion_matrix.png      # Confusion matrix
‚îÇ       ‚îú‚îÄ‚îÄ training_history.png      # –ì—Ä–∞—Ñ–∏–∫ –æ–±—É—á–µ–Ω–∏—è –∑–∞ –≤—Å–µ —ç–ø–æ—Ö–∏
‚îÇ       ‚îî‚îÄ‚îÄ training_epoch_*.png      # –ì—Ä–∞—Ñ–∏–∫–∏ –Ω–∞ –∫–∞–∂–¥–æ–π —ç–ø–æ—Ö–µ
‚îú‚îÄ‚îÄ üìÅ models/                        # –§–∏–Ω–∞–ª—å–Ω—ã–µ –º–æ–¥–µ–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ best_model.onnx               # –õ—É—á—à–∞—è –º–æ–¥–µ–ª—å –≤ —Ñ–æ—Ä–º–∞—Ç–µ ONNX
‚îÇ   ‚îî‚îÄ‚îÄ best_model_info.json          # –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏
‚îú‚îÄ‚îÄ üìÅ app/                           # –í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îÇ   ‚îî‚îÄ‚îÄ best_model_classifier.py     # Gradio –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å ONNX –º–æ–¥–µ–ª—å—é
‚îú‚îÄ‚îÄ üìÅ logs/                         # –õ–æ–≥–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–∞–π–ø–ª–∞–π–Ω–∞
‚îÇ
‚îú‚îÄ‚îÄ üìÑ train.py                      # –û—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏
‚îú‚îÄ‚îÄ üìÑ data_preprocessing.py          # –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∏ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ üìÑ train_both_models.py          # –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π –∏ –≤—ã–±–æ—Ä –ª—É—á—à–µ–π
‚îú‚îÄ‚îÄ üìÑ export_model.py               # –≠–∫—Å–ø–æ—Ä—Ç PyTorch –º–æ–¥–µ–ª–∏ –≤ ONNX
‚îú‚îÄ‚îÄ üìÑ run_full_pipeline.py          # –ü–æ–ª–Ω—ã–π –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π pipeline
‚îú‚îÄ‚îÄ üìÑ config.py                     # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞
‚îú‚îÄ‚îÄ üìÑ requirements.txt               # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Python
‚îî‚îÄ‚îÄ üìÑ README.md                      # –≠—Ç–æ—Ç —Ñ–∞–π–ª
```

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
```

### 2. –ü–æ–ª–Ω—ã–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–∞–π–ø–ª–∞–π–Ω (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

–í—ã–ø–æ–ª–Ω—è–µ—Ç –≤—Å–µ —à–∞–≥–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏: –ø–æ–¥–≥–æ—Ç–æ–≤–∫—É –¥–∞–Ω–Ω—ã—Ö, –æ–±—É—á–µ–Ω–∏–µ –æ–±–µ–∏—Ö –º–æ–¥–µ–ª–µ–π, —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ, —ç–∫—Å–ø–æ—Ä—Ç –≤ ONNX –∏ –∑–∞–ø—É—Å–∫ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:

```bash
python run_full_pipeline.py
```

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç:
1. ‚úÖ –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç –¥–∞–Ω–Ω—ã–µ (—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ train/val/test)
2. ‚úÖ –û–±—É—á–∏—Ç ResNet18 (20 —ç–ø–æ—Ö)
3. ‚úÖ –û–±—É—á–∏—Ç EfficientNet-B0 (20 —ç–ø–æ—Ö)
4. ‚úÖ –°—Ä–∞–≤–Ω–∏—Ç –º–æ–¥–µ–ª–∏ –∏ –≤—ã–±–µ—Ä–µ—Ç –ª—É—á—à—É—é
5. ‚úÖ –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –ª—É—á—à—É—é –º–æ–¥–µ–ª—å –≤ ONNX
6. ‚úÖ –ó–∞–ø—É—Å—Ç–∏—Ç Gradio –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –æ—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä: `http://localhost:8080`

### 3. –ü–æ—à–∞–≥–æ–≤–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ (–≤—Ä—É—á–Ω—É—é)

#### –®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö

```bash
python data_preprocessing.py
```

–†–∞–∑–¥–µ–ª—è–µ—Ç –¥–∞—Ç–∞—Å–µ—Ç –Ω–∞ train (70%), val (15%), test (15%) —Å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º random seed (42).

#### –®–∞–≥ 2: –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π

**ResNet18:**
```bash
python train.py --model resnet18 --epochs 20 --lr 0.001 \
    --freeze_epochs 5 --head_lr 0.001 --backbone_lr 0.0002
```

**EfficientNet-B0:**
```bash
python train.py --model efficientnet_b0 --epochs 20 --lr 0.001 \
    --freeze_epochs 5 --head_lr 0.001 --backbone_lr 0.0001
```

#### –®–∞–≥ 3: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π

```bash
python train_both_models.py
```

–°–∫—Ä–∏–ø—Ç:
- –ù–∞—Ö–æ–¥–∏—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã –¥–ª—è –∫–∞–∂–¥–æ–π –º–æ–¥–µ–ª–∏
- –°—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç –º–µ—Ç—Ä–∏–∫–∏ (test_accuracy, val_accuracy, —Ä–∞–∑–º–µ—Ä –º–æ–¥–µ–ª–∏)
- –í—ã–±–∏—Ä–∞–µ—Ç –ª—É—á—à—É—é –º–æ–¥–µ–ª—å (–ø–æ test_accuracy, –ø—Ä–∏ —Ä–∞–≤–µ–Ω—Å—Ç–≤–µ ‚Äî –ø–æ —Ä–∞–∑–º–µ—Ä—É)
- –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –ª—É—á—à—É—é –º–æ–¥–µ–ª—å –≤ `models/best_model.onnx`
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤ `models/best_model_info.json`

#### –®–∞–≥ 4: –ó–∞–ø—É—Å–∫ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

```bash
python app/best_model_classifier.py --port 8080
```

–û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä: `http://localhost:8080`

## üéì –°—Ç—Ä–∞—Ç–µ–≥–∏—è Transfer Learning

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –æ—Å–æ–∑–Ω–∞–Ω–Ω—É—é —Å—Ç—Ä–∞—Ç–µ–≥–∏—é **freeze ‚Üí unfreeze**:

1. **–≠—Ç–∞–ø 1 (Freeze Backbone)**: –ü–µ—Ä–≤—ã–µ N —ç–ø–æ—Ö (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 5)
   - –ó–∞–º–æ—Ä–∞–∂–∏–≤–∞—é—Ç—Å—è –≤—Å–µ —Å–ª–æ–∏ backbone (–ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—ã–µ –≤–µ—Å–∞)
   - –û–±—É—á–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–æ–Ω–Ω—ã–π head —Å –≤—ã—Å–æ–∫–∏–º learning rate
   - –¶–µ–ª—å: –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å head –ø–æ–¥ –Ω–æ–≤—É—é –∑–∞–¥–∞—á—É, —Å–æ—Ö—Ä–∞–Ω—è—è learned features

2. **–≠—Ç–∞–ø 2 (Unfreeze All)**: –û—Å—Ç–∞–ª—å–Ω—ã–µ —ç–ø–æ—Ö–∏
   - –†–∞–∑–º–æ—Ä–∞–∂–∏–≤–∞—é—Ç—Å—è –≤—Å–µ —Å–ª–æ–∏ –º–æ–¥–µ–ª–∏
   - Head –æ–±—É—á–∞–µ—Ç—Å—è —Å –≤—ã—Å–æ–∫–∏–º LR (–Ω–∞–ø—Ä–∏–º–µ—Ä, 1e-3)
   - Backbone –æ–±—É—á–∞–µ—Ç—Å—è —Å –Ω–∏–∑–∫–∏–º LR (–Ω–∞–ø—Ä–∏–º–µ—Ä, 2e-4)
   - –¶–µ–ª—å: —Ç–æ–Ω–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –≤—Å–µ–π –º–æ–¥–µ–ª–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è –º–µ—Ç—Ä–∏–∫

### –ì–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

- **–≠–ø–æ—Ö–∏ –æ–±—É—á–µ–Ω–∏—è**: 20
- **Freeze epochs**: 5
- **Head LR**: 1e-3 (0.001)
- **Backbone LR –ø–æ—Å–ª–µ —Ä–∞–∑–º–æ—Ä–æ–∑–∫–∏**: 2e-4 (0.0002) –¥–ª—è ResNet18, 1e-4 (0.0001) –¥–ª—è EfficientNet
- **Batch size**: 32
- **–û–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä**: AdamW
- **Random seed**: 42 (–¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏)

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–∞–π–ø–ª–∞–π–Ω–∞ –≤—ã –ø–æ–ª—É—á–∏—Ç–µ:

### –ú–µ—Ç—Ä–∏–∫–∏ –≤ `experiments/[model]_experiment_[timestamp]/results.json`:
- `test_accuracy`: –¢–æ—á–Ω–æ—Å—Ç—å –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–º –Ω–∞–±–æ—Ä–µ
- `best_val_accuracy`: –õ—É—á—à–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å
- `confusion_matrix`: –ú–∞—Ç—Ä–∏—Ü–∞ –æ—à–∏–±–æ–∫
- `classification_report`: –î–µ—Ç–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç –ø–æ –∫–ª–∞—Å—Å–∞–º
- `training_time_minutes`: –í—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è
- `model_info`: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏ —Ä–∞–∑–º–µ—Ä –º–æ–¥–µ–ª–∏

### –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏:
- `training_history.png`: –ì—Ä–∞—Ñ–∏–∫ loss –∏ accuracy –∑–∞ –≤—Å–µ —ç–ø–æ—Ö–∏
- `training_epoch_*.png`: –ì—Ä–∞—Ñ–∏–∫–∏ –Ω–∞ –∫–∞–∂–¥–æ–π —ç–ø–æ—Ö–µ (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–æ)
- `confusion_matrix.png`: –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –º–∞—Ç—Ä–∏—Ü—ã –æ—à–∏–±–æ–∫

### –õ—É—á—à–∞—è –º–æ–¥–µ–ª—å:
- `models/best_model.onnx`: ONNX –º–æ–¥–µ–ª—å –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞
- `models/best_model_info.json`: –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–û—Å–Ω–æ–≤–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –≤ `config.py`:

### DataConfig:
- `classes`: –°–ø–∏—Å–æ–∫ –∫–ª–∞—Å—Å–æ–≤ –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏
- `image_size`: –†–∞–∑–º–µ—Ä –≤—Ö–æ–¥–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 224x224)
- `batch_size`: –†–∞–∑–º–µ—Ä –±–∞—Ç—á–∞
- `train_split`, `val_split`, `test_split`: –ü—Ä–æ–ø–æ—Ä—Ü–∏–∏ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö

### ModelConfig:
- `num_epochs`: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ø–æ—Ö –æ–±—É—á–µ–Ω–∏—è
- `learning_rate`: –ë–∞–∑–æ–≤—ã–π learning rate
- `freeze_epochs`: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ø–æ—Ö —Å –∑–∞–º–æ—Ä–æ–∂–µ–Ω–Ω—ã–º backbone
- `head_lr`: Learning rate –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ head
- `backbone_lr`: Learning rate –¥–ª—è backbone –ø–æ—Å–ª–µ —Ä–∞–∑–º–æ—Ä–æ–∑–∫–∏
- `optimizer`: –û–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä (AdamW, Adam, SGD)

### ExperimentConfig:
- `random_seed`: Seed –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 42)
- `use_tensorboard`: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å TensorBoard –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
- `save_plots_every_epoch`: –°–æ—Ö—Ä–∞–Ω—è—Ç—å –≥—Ä–∞—Ñ–∏–∫–∏ –Ω–∞ –∫–∞–∂–¥–æ–π —ç–ø–æ—Ö–µ

## üìà –ü—Ä–∏–º–µ—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### ResNet18:
- Test Accuracy: **96.61%**
- Val Accuracy: **98.11%**
- –ü–∞—Ä–∞–º–µ—Ç—Ä–æ–≤: 11.2M
- –†–∞–∑–º–µ—Ä –º–æ–¥–µ–ª–∏: 42.64 MB

### EfficientNet-B0:
- Test Accuracy: **96.61%**
- Val Accuracy: **96.23%**
- –ü–∞—Ä–∞–º–µ—Ç—Ä–æ–≤: 4.0M
- –†–∞–∑–º–µ—Ä –º–æ–¥–µ–ª–∏: **15.30 MB**

**–í—ã–±–æ—Ä**: EfficientNet-B0 (–ø—Ä–∏ –æ–¥–∏–Ω–∞–∫–æ–≤–æ–π test_accuracy –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è –º–æ–¥–µ–ª—å —Å –±–æ–ª—å—à–∏–º val accuracy)

## üåê –í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

–í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ –±–∞–∑–µ Gradio –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç:

- üì§ –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Ñ—Ä—É–∫—Ç–æ–≤
- üîç –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
- üìä –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π –ø–æ –∫–ª–∞—Å—Å–∞–º
- ‚ÑπÔ∏è –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏
- üíæ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π ONNX –º–æ–¥–µ–ª–∏

### –ó–∞–ø—É—Å–∫:
```bash
python app/best_model_classifier.py --port 8080 --host 127.0.0.1
```

–û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä: `http://127.0.0.1:8080`

## üìù –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

–û—Å–Ω–æ–≤–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (—Å–º. `requirements.txt`):

- Python 3.9+
- PyTorch 2.0+
- torchvision
- timm (–¥–ª—è –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π)
- onnx, onnxruntime (–¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ –∏ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞)
- gradio (–¥–ª—è –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞)
- numpy, pandas, matplotlib, seaborn
- scikit-learn
- tqdm (progress bars)

## üîç –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

1. **–í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç—å**: –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ random seeds –Ω–∞ –≤—Å–µ—Ö —É—Ä–æ–≤–Ω—è—Ö
2. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ**: –ü–æ–∏—Å–∫ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤ –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫
3. **–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ —Ä–∞–∑–Ω–∏—Ü—ã –º–µ–∂–¥—É val –∏ test accuracy
4. **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏–Ω—Ñ–µ—Ä–µ–Ω—Å**: ONNX –º–æ–¥–µ–ª–∏ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ CPU –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞
5. **–ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä—ã**: –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –æ–±—É—á–µ–Ω–∏—è —Å –ø–æ–º–æ—â—å—é tqdm
6. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**: –í—Å–µ —à–∞–≥–∏ –ø–∞–π–ø–ª–∞–π–Ω–∞ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ `logs/`

## üõ†Ô∏è –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### –ü—Ä–æ–±–ª–µ–º–∞: "–û–±—É—á–∞—é—â–∏–π –¥–∞—Ç–∞—Å–µ—Ç –ø—É—Å—Ç"
**–†–µ—à–µ–Ω–∏–µ**: –ó–∞–ø—É—Å—Ç–∏—Ç–µ `python data_preprocessing.py` –¥–ª—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö

### –ü—Ä–æ–±–ª–µ–º–∞: –û—à–∏–±–∫–∏ –∫–æ–¥–∏—Ä–æ–≤–∫–∏ Unicode –≤ Windows
**–†–µ—à–µ–Ω–∏–µ**: –£–∂–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ –∫–æ–¥–µ, –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –º–µ—Ç–∫–∏ –≤–º–µ—Å—Ç–æ —ç–º–æ–¥–∑–∏

### –ü—Ä–æ–±–ª–µ–º–∞: "Invalid HTTP request" –≤ Gradio
**–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ñ–∏–ª—å—Ç—Ä—É—é—Ç—Å—è, —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ (–±—Ä–∞—É–∑–µ—Ä –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç favicon)

### –ü—Ä–æ–±–ª–µ–º–∞: –ú–æ–¥–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ –ø—Ä–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏
**–†–µ—à–µ–Ω–∏–µ**: –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –æ–±–µ –º–æ–¥–µ–ª–∏ –æ–±—É—á–µ–Ω—ã (–∑–∞–ø—É—Å—Ç–∏—Ç–µ `train.py` –¥–ª—è –∫–∞–∂–¥–æ–π)
